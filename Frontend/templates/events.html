<script>
    document.addEventListener('DOMContentLoaded', () => {
        fetch('/api/meeting/')
            .then(response => response.json())
            .then(data => {
                data.forEach(meeting => {
                    document.querySelector(".gaming").innerHTML = `
                    <div style=" background-color:red;">
                    <p>${meeting.meeting_name}</p>
                    <p>${meeting.meeting_time}</p>
                    </div>
                `;
                    //document.querySelector('p').appendChild(row);
                    console.log(meeting.meeting_name, meeting.meeting_time, meeting.id_project, meeting.meeting_name, meeting.meeting_date);

                });
            })
            .catch(error => {
                console.error('Error fetching user data:', error);
            });
    });
</script>
<div id="calendar" class="container">
    <h1>Kalendarz</h1>
    <table class="meeting-table">
        <thead>
            <tr>
                <th>Poniedziałek</th>
                <th>Wtorek</th>
                <th>Środa</th>
                <th>Czwartek</th>
                <th>Piątek</th>
                <th>Sobota</th>
                <th>Niedziela</th>
            </tr>
        </thead>
        <tbody id="week-body">
            <script>
                const daysInMonth = (year, month) => new Date(year, month, 0).getDate();

                var year = 2024;
                var month = 5;

                function NextMonth(curmonth,value,curyear){
                   month = curmonth + value;
                   if(month>12){
                        month = 1;
                        year = curyear+1;
                   }
                   if(month<1){
                        month = 12;
                        year = curyear -1;
                   }
                   

                    console.log(month,year)
                    return [month,year];
                }
                function genCalendar(year,month)
                {
                    
                    while( document.getElementById("week-body").lastElementChild)
                    {
                        document.getElementById("week-body").removeChild(document.getElementById("week-body").lastElementChild);
                    }
                    
                    day = 1 - new Date(year, month - 1, 1).getDay();
                    for (let j = 0; j < (daysInMonth(year, month)+0.00000000000001) / 7; j++) {
                        
                        const row = document.createElement("tr");
                        /*
                        if(day == 0){
                            for(let c =0; c<6;c++){
                                row.appendChild(document.createElement("td"));
                            }
                                                         
                        }
                        */
                    for (let i = 1; i <= 7; i++) {
                        const cell = document.createElement("td");
                        day += 1;

                        if (day <= daysInMonth(year, month) && day > 0) {
                            cell.textContent = day;
                            row.appendChild(cell);
                            console.log(day);
                        }
                        else if (day < 0) {
                            row.appendChild(cell);
                        }else{
                            row.appendChild(cell);
                        }
                        
                    }
                    document.getElementById("week-body").appendChild(row);
                }
                }                
            </script>
        </tbody>
    </table>
    <button onclick="NextMonth(month,1,year); genCalendar(year,month);">GUZIK[+1]</button>
    <button onclick="NextMonth(month,-1,year); genCalendar(year,month);">GUZIK[-1]</button>
    <p class="gaming"></p>
</div>